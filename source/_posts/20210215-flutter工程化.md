---
title: 'Flutter工程化'
categories:
- Flutter
tags: 
- Flutter
- 客户端
description: flutter基础设施搭建
cover: https://blog-misaka1033.oss-cn-beijing.aliyuncs.com/blog/images/84188961_p0.webp
---

# 概要

## 内容

1. Flutter在windows中的环境搭建
2. 构建Flutter基本的工程模板
3. 如何启动一个从github下载的Flutter项目
4. Flutter工程结构中，各种文件的意义
5. 上述流程中遇到的错误记录

# Flutter环境搭建

> 因为个人用的是Windows，因此只讨论该操作系统下Flutter环境的构建。
> 环境搭建流程较长，其包含了Flutter工具链，Andorid，Java工具链的一系列安装和环境变量配置，请务必保证flutter doctor成功，这是Flutter的自检工具。

## 安装Flutter SDK

### 镜像环境变量配置

[最新镜像](https://flutter.io/community/china)

| 变量名                   | 路径                          | 描述 |
| ------------------------ | ----------------------------- | ---- |
| PUB_HOSTED_URL           | https://pub.flutter-io.cn     |      |
| FLUTTER_STORAGE_BASE_URL | https://storage.flutter-io.cn |      |

### 前置工具安装

1. Git for Windows. 因为Flutter SDK的版本控制，是通过github维护的，因为其集成工具中，会调用git指令，故请确保命令行中git指令的可执行。

### Flutter SDK安装

1. [官网下载安装包](https://flutter.dev/docs/development/tools/sdk/releases)
2. [github下载](https://github.com/flutter/flutter/releases)

下载完成后，解压到自定义的文件夹，这就是flutter sdk的目录了。其中，dart也已经包含在目录下的bin文件夹下了。

为了可以在命令行中访问到flutter指令，需要配置环境变量

| 变量名       | 路径                    | 描述                                                           |
| ------------ | ----------------------- | -------------------------------------------------------------- |
| FLUTTER_HOME | D:\software\flutter\bin | 修改path是危险的事情，为了减少修改，定义额外的变量进行路径控制 |
| Path         | %FLUTTER_HOME%          |                                                                |

### Java SDK 安装

> Android Studio依赖了Java开发环境，jdk，jre都安装了就行。

| 变量名    | 路径                | 描述 |
| --------- | ------------------- | ---- |
| CLASSPATH | .;%JAVA_HOME%\lib   |      |
| JAVA_HOME | D:\software\JavaSDK |      |
| Path      | %JAVA_HOME%\bin     |      |

### Android Studio 安装

> Flutter依赖Android Studio全量安装，用来管理android模拟器环境，SDK版本等.

[国内Android Studio下载](http://www.android-studio.org/)


### Flutter doctor指令

> 一般会遇到一个安卓证书安装的问题，按照指引安装就可以了。网不好，就多试试，或者更换网络。

### Flutter SDK 分支的管理

> Flutter在github上管理，其分支众多，推荐使用stable分支，为稳定分支。
> 此处介绍些sdk更新指令，同时也介绍部分依赖包获取，更新指令

``` bash

// 查看当前追踪的分支
flutter channel

// 升级flutter sdk，大概率卡死，也可以直接使用git指令更新
// 同时也会更新flutter项目依赖包
flutter upgrade

// 获取项目所有依赖包
flutter packages get

// 更新项目依赖包
flutter packages upgrade

```

# 关于IDE

> Windows系统中，只考虑两个IDE，Android Studio和VS Code

## Android Studio

### 些许配置

Flutter SDK Path
* 配置位置：如果是新工程，在创建时会询问配置位置
* 配置内容：


Dart SDK位置

* 配置位置：
* 配置内容：

Android SDK

* ![android studio配置位置](https://blog-misaka1033.oss-cn-beijing.aliyuncs.com/blog/images/微信图片_20210228134230.png) 
* ![SDK文件所在位置](https://blog-misaka1033.oss-cn-beijing.aliyuncs.com/blog/images/微信图片_20210228134504.png)

### Android Studio的技巧

1. 可以直接使用flutter指令
![可以直接使用flutter指令](https://blog-misaka1033.oss-cn-beijing.aliyuncs.com/blog/images/微信图片_20210228134508.png)

### 一些问题

第一次跑flutter项目，会进行环境配置，会进行gradle,远程下载gradle被墙了,大概率卡死.[Gradle问题参考](https://blog.csdn.net/qq_41976613/article/details/104394870)

应该是flutter运行需要 running Gradle task 'assembleDebug',因为需要先下载配置Gradle

如果实在不行，可以手动下载
* 其本地位置： ![本地位置](https://blog-misaka1033.oss-cn-beijing.aliyuncs.com/blog/images/微信截图_20210217100014.png)
* 查看版本: ![Gradle版本](https://blog-misaka1033.oss-cn-beijing.aliyuncs.com/blog/images/微信图片_20201018224741.png)
* [去Gradle网站手动下载](https://services.gradle.org/distributions),把zip放进去就行，好像会自动解压？

还可以换源下载



## VS Code

# 初始工程


# 运行存在的项目

# 工程结构解析

# 常见错误日志

# 技巧

## 无线调试

### 设备号获取

第一次需要数据线连接手机

``` bash
adb devices
```

可获取到设备号 8eca7cab

### 开启网络调试

``` bash
adb -s 8eca7cab tcpip 5555
```

结果: restarting in TCP mode Port 5555

### 连接

拔掉数据线，执行
``` bash
    // 连接
    adb connect 手机ip:5555
    //connected to 192.168.0.106:5555

    // 查看
    adb devices
    // 192.168.0.106:5555 device

    // 关闭
    adb disconnect [phone_ip]:[port]
```





# 参考资料

1. [Flutter实战](https://book.flutterchina.club/)
2. [Flutter中文网](https://flutterchina.club/get-started/install/)